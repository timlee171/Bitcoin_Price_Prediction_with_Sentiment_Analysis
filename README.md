# Bitcoin_price_prediction_with_Sentiment_Analysis
# Abstract
Predicting stock price is always a hot topic in the Machine learning field, including predicting the cryptocurrency market. Due to its volatility, it is a challenging task that no one can predict the future price accurately. Nowadays, people use social media to express their opinions such as Twitter and Reddit. We found that stock price movements are strongly correlated to public sentiment. Previous papers also proved that sentiment analysis is an effective method to improve the accuracy of prediction. Among all the cryptocurrencies, Bitcoin is the leading crypto, which has a great influence on the whole market. The thesis of the work is to use sentiment analysis with multiple social media sentiment comments to improve the accuracy of predicting Bitcoin price. Along with sentiment analysis, the present paper uses Long Short-Term Memory (LSTM) to train the model, and we use RMSE to examine the results. Experiments training with different features are conducted to compare the importance of the features, a total of 6 experiments. In the end, the results show that exploiting more social media datasets results in lower RMSE. 

**Keywords**
Bitcoin, Bitcoin Prediction, Cryptocurrency, Machine Learning, Artificial Intelligence, Long short-term Memory(LSTM), Sentiment Analysis, Reddit, Twitter

# Introduction
Bitcoin has been a popular stock in the cryptocurrency market in recent year. Since 2009 the bitcoin was first introduced to the market, its value starting from 0.0008 USD, went up to the peak of 60000 USD, which was millions times the original price. More people had closely followed Bitcoin and joined the cryptocurrency market. The prediction of Bitcoin became a hot topic in the data science field. However,  due to its high volatility, price prediction becomes a difficult task, and many data scientists try to find the best way to train a model with high accuracy. Based on previous studies, considering only historical data as input was not good enough for training the model. On the other hand, other studies showed that the cryptocurrency market was  heavily influenced by new and  recent events. Because of unpredictable news and events, stock prices do not follow a pattern and cannot be predicted with more than 50% accuracy. 
Nowadays, people heavily rely on social media and it has become part of our lives. It is also a good resource to find data and do further social science research. In the data science field, social media such as Reddit and Twitter can provide lots of social data, including public sentiment comments. In Reddit, a Bitcoin subgroup is created just for Bitcoin and cryptocurrency information. On Twitter, more than millions of users post over 140 million tweets every day. Each tweet contains 140 characters and it can hashtag the topic to make it available to more people. Many influencers in the cryptocurrency market declare their comment on Twitter and Reddit. Oftentimes, these tweets or Reddit posts influence the market immediately. With public sentiment reports, the model can learn the correlation of sentiment with certain incidents happening in the cryptocurrency  market and reflect the influence on the price. 
In this paper, we employ sentiment analysis with social media data to help market prediction. Sentiment classifiers categorize texts into positive and negative based on the 
corpus. It helps models to learn the sentiment and transform it as features. Many studies proved that sentiment analysis works well on market prediction. Besides the sentiment analysis data, we also include historical prices of Bitcoin, Litecoin, and Ethereum. In previous studies, the researchers only contained one year of historical 
data. They concluded that more historical data may improve the accuracy of prediction. Thus, in this paper,  We included Bitcoin, Litecoin, and Ethereum price data from 2018 to 2022. We believe that historical price data helps the model to learn the stock movement in bull and bear markets. We conduct 6 experiments training models with different 
combinations of features. We want to test several hypotheses with the results. First, whether sentiment analysis helps predict future Bitcoin prices. Second, whether longer 
timeframe historical data has better accuracy of prediction than shorter timeframe.  

# Sentiment Analysis
Sentiment Analysis applies to many fields. Much sentiment analysis research is conducted in movies, news, and stock markets and a lot of open resources can be found on the internet. We read some papers about sentiment analysis on stock price prediction and found them helpful. Thus we decided to use the same sentiment analysis method from our 
parent paper for our paper. After cleaning the data, We apply sentiment analysis on our Reddit data. We use two packages for sentiment analysis. The first one is Flair, which allows the machine to categorize whether the sentence is positive, negative, or neutral followed by a confidence score. This output allows our future model to understand whether this Reddit post is 1. strong positive 2. moderate positive 3. mild positive 4. neutral 5. mild negative 6. moderate negative or 7. strong negative. The second package is Vader, which allows the machine to analyze the text with two categories, polarity and subjectivity. Polarity demonstrates the text sentiment, where 1 is positive and -1 is negative. The output lies between 1 and -1. Subjectivity, on the other hand, demonstrates whether this text contains more personal opinions or factual 
judgments. The output lies between 0 and 1, where 1 represents total personal opinion and 0 represents total factual judgments. We also implemented the Python Vader sentiment analysis package for Twitter. It returns each tweet a positive, negative, neutral, and compound score. The compound score is computed by normalizing the positive, negative, and neutral scores. After sentiment analysis of both Reddit and Twitter, we combined two scores into one and saved it as final data. 

# LSTM Model
In previous studies, the LSTM model outperformed other models such as the GRU stacked model and LSTM stacked model. LSTM is an advanced RNN model which gets insight 
from past data and processes the sequence of data into input, output, and forget gates. LSTM performs well in classifying, processing, and making predictions with time series data. Thus, we decide to use only the LSTM model for our prediction.  We pass different combinations of features into models and try to test several assumptions: Whether Reddit posts sentiment reports and Tweet sentiment reports help models predict better, and whether larger periods of the dataset have better accuracy of prediction. Six experiments are executed and the performance of the models is evaluated by Root Mean Square Error (RMSE). The 1st experiment uses the historical price of Bitcoin Ethereum and Litecoin(open, high, low, close price), volume of Litecoin, sentiment data of Reddit, and sentiment data of Twitter. The 2nd experiment takes only the historical price and volume mentioned above and the sentiment data of Twitter. The 3rd experiment takes only the price data and volume data mentioned above. The 4th experiment takes 
the price and volume data with the sentiment data of Reddit. Lastly, the 5th experiment runs a smaller timeframe with the price only given by [1] for us to compare. Since the RMSE score can not be compared for the big timeframe and the small timeframe, we decided to calculate the average percentage of differences between the actual price and the predicted price produced by the model of experiments 3 and 5 to see if a higher timeframe enhances the model prediction due to the generalization the higher timeframe data gives.

# Results and Discussion
Here are the results from each experiment
- Experiment 1 shows that using all features, the RMSE score resulted in 1267.35, with an average percentage of error of  4.675%
- Experiment 2 shows that using all features but not reddit sentiment, the RMSE score resulted in 686.78, with an average percentage of error of 2.244%
- Experiment 3 shows that using only the price data, the RMSE score resulted in 1197.93, with an average percentage of error of  4.406%
- Experiment 4 shows that using all features but not Twitter sentiment, the RMSE score resulted in 786.02, with an average percentage of error of 2.6%
- Experiment 5 shows that using only the price data with the smaller data set, the RMSE score resulted in 418.97, with an average percentage of error of  3.816%
- Experiment 6 shows that using all features with smaller data the RMSE score resulted in 221.95, with an average percentage of error of  1.704%

As we mentioned above, the two key assumptions we want to figure out are:  
1. If Reddit and Twitter sentiment enhance model training? 
2. Does higher timeframe data enhance prediction?

To understand the first assumption, we compared several pairs, which are experiment 1 and experiment 3, experiment 2 and experiment 4, and experiment 1 and experiment 4. 
The first pair of results tells us that solely using price data can still outrun the performance using all sentiments. However, the second pair of results shows an outstanding performance on using only one sentiment source along with the price data can still outrun the performance of using either all features or using only price data. Also, the second pair shows that Twitter sentiment can perform slightly better compared to Reddit sentiment. The third pair of results indicates that using only one source of sentiment can perform better compared to using multiple sources of sentiment.  For the second assumption, we compared the results from experiments 3 and 5. The result showed that as we increase the timeframe, the performance of solely using the price data to make predictions gets worse. This also answers the issue [1] indicated, where they stated that the market is complicated and does not perform based on past movements, and as the timeframe increases, using solely the price data will not do as well as the small timeframe did. We can also see that comparing experiment 1 and experiment 6, the model still works better in the small dataset. The result shows that a smaller timeframe of data has a lower RMSE.

## Results of experiment 6
<img src="https://github.com/timlee171/Bitcoin_price_prediction_with_Sentiment_Analysis/blob/main/Results/Exp6/expr_6.png" width=70% height=90%>

# Conclusion
In this paper, we have shown that models with a short timeframe of data generally outperform the models with a long timeframe of data, with or without sentiment analysis. 
The possible explanation is that the cryptocurrency market is extremely volatile and hard to predict. If models learn longer and more general data to predict the Bitcoin market, the model can only predict relatively general prices. However, most of the time, the Bitcoin market fluctuates drastically. Thus, there will be a large loss between the predicted price and the actual price. Between results in experiments 2, 3, and 4, we can conclude that Reddit and Twitter are good sources for sentiment analysis on Bitcoin price prediction. We can also make another conclusion: Models with single-source sentiment data outperform models with multiple sources of sentiment data. In our results, the best performance of the model is trained with historical price data with either Reddit or Twitter sentiments. Both RMSE scores, 686.78 and 786.02, are lower than the model trained with historical price, Reddit, and Twitter sentiments, 1267.35. The outcome disproves previous studies’ assumption: that exploiting multiple social media data can avoid being biased because people who trade in the cryptocurrency market could express their opinions on more than one platform. The possible explanation for this result is that combining different sources of sentiment data will increase the dimension of the table. Thus, the data will become noisier and cause the model performance worse.  

# Future Work
The results of our experiments are inspiring, but there are several alternative methods to extend in this paper. First, we could split the training data into several sets. Bitcoin price movement has different traits in each type of market. Thus, we can train the model based on the market types: uptrend, downtrend, and sideways trend. If we train the model with separated datasets, the model might learn better in certain markets. In the future, if we know the incoming market type, we could use such type of model to predict Bitcoin price. However, a shorter period of the dataset could provide less information to the model and cause the model to overfit. This research requires further discussion. In the tweet data, we have filtered the data with a minimum of 100 likes and obtained 140,000 datasets. The data could represent most of the public opinions. In future studies, The tweet data could be filtered with a higher threshold, for example, a minimum of 1000 likes, and a minimum of 1000 replies. This dataset represents the people's opinions with more influence on Twitter. Their sentiment score can be more suitable to represent the overall public’s sentiment. In other ways, we can incorporate crypto influencers’ tweets and add more weight to their tweets. Both methods are built on the assumption that market influencers have more authority and power in the Bitcoin market.  For the results of using only one sentiment data source outperforms those using all sentiment data, we assume that since all sentiments are used, the dimensionality of the data became higher and noisier. To adjust this issue in future studies, one can apply trainable initial hidden state to reconstruct the high dimensional data before each iteration and reduce noise. This approach is proven to be useful for categorical problems in [3], but further research should be done to see if this approach is suitable for regression problems.  While training the LSTM model, we tuned only the epoch to improve the results. Other parameters such as look-back days, layers of the model, and batch size are crucial factors to influence the model. Our model’s parameters are based on the previous studies’ best results and we did not make further adjustments. In future work, Hypertuning can be an important process to train models better. 

# Reference
[1]  Prajapati, P. (2020). Predictive analysis of Bitcoin price considering social sentiments. arXiv. https://doi.org/10.48550/arXiv.2001.10343 

[2] Pagolu, V. S., Challa, K. N., Panda, G., & Majhi, B. (2016). Sentiment Analysis of Twitter Data for Predicting Stock Market Movements. arXiv. https://doi.org/10.48550/arXiv.1610.09225 

[3] Hwang, J. (2020). Modeling Financial Time Series using LSTM with Trainable Initial Hidden States. arXiv. https://doi.org/10.48550/arXiv.2007.06848
